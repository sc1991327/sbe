// only read .bmp
// if want change need to find and change *.bmp

#include <queue>
#include <string>

using namespace std;

class CBrowseDir
{
protected:
	//absolute path, end by /
	char m_szInitDir[1000];

public:
	CBrowseDir();

	// return false means the dir is wrong
	bool SetInitDir(const char *dir);

	// start browse.
	bool BeginBrowse(const char *filespec);

	queue<string> FileNames;

protected:

	bool BrowseDir(const char *dir, const char *filespec);
	virtual bool ProcessFile(const char *filename);
	virtual void ProcessDir(const char *currentdir, const char *parentdir);

};

class CStatDir :public CBrowseDir
{
protected:
	int m_nFileCount;
	int m_nSubdirCount; 

public:
	CStatDir()
	{
		m_nFileCount = m_nSubdirCount = 0;
	}

	int GetFileCount()
	{
		return m_nFileCount;
	}

	int GetSubdirCount()
	{
		return m_nSubdirCount - 1;
	}

protected:
	virtual bool ProcessFile(const char *filename)
	{
		m_nFileCount++;
		return CBrowseDir::ProcessFile(filename);
	}

	virtual void ProcessDir
		(const char *currentdir, const char *parentdir)
	{
		m_nSubdirCount++;
		CBrowseDir::ProcessDir(currentdir, parentdir);
	}
};